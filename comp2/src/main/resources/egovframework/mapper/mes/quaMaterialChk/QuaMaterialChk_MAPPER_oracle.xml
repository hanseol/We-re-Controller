<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mes.qua.chk.service.impl.QuaMaterialChkMapper">
	

	<resultMap id="quaMaterialChk" type="mes.qua.chk.service.QuaMaterialChkVO">
		<result property="quaMaterialStatement" column="QUA_MATERIAL_STATEMENT" />
		<result property="quaMaterialDate" column="QUA_MATERIAL_DATE" />
		<result property="erpVendorCode" column="ERP_VENDOR_CODE" />
		<result property="comMaterialCode" column="COM_MATERIAL_CODE" />
		<result property="quaMaterialChk" column="QUA_MATERIAL_CHK" />
		<result property="quaMaterialPQty" column="QUA_MATERIAL_P_QTY" />
		<result property="quaMaterialFQty" column="QUA_MATERIAL_F_QTY" />
		<result property="quaMaterialChkDate" column="QUA_MATERIAL_CHK_DATE" />
		<result property="erpMaterialOrderCode" column="ERP_MATERIAL_ORDER_CODE" />
	</resultMap>
	<resultMap id="erpMaterialOrder" type="mes.mat.order.service.ErpMaterialOrderVO">
		<result property="erpMaterialOrderCode"	column="ERP_MATERIAL_ORDER_CODE" />
		<result property="comMaterialCode" column="COM_MATERIAL_CODE" />
		<result property="erpMaterialOrderQty" column="ERP_MATERIAL_ORDER_QTY" />
		<result property="erpVendorCode" column="ERP_VENDOR_CODE" />
		<result property="erpMaterialUnitPrice"	column="ERP_MATERIAL_UNIT_PRICE" />
		<result property="erpMaterialOrderDate" column="ERP_MATERIAL_ORDER_DATE" />
		<result property="erpMaterialRequestDate" column="ERP_MATERIAL_REQUEST_DATE" />
	</resultMap>
	<resultMap id="matInout" type="mes.mat.inout.service.MatInoutVO">
		<result property="matInoutStatement" column="MAT_INOUT_STATEMENT" />
		<result property="comMaterialCode" column="COM_MATERIAL_CODE" />
		<result property="matInoutDate" column="MAT_INOUT_DATE" />
		<result property="matInoutGubun" column="MAT_INOUT_GUBUN" />
		<result property="matInoutQuantity" column="MAT_INOUT_QUANTITY" />
		<result property="matLotNo" column="MAT_LOT_NO" />
		<result property="comProcessCode" column="COM_PROCESS_CODE" />
		<result property="matInoutUnitPrice" column="MAT_INOUT_UNIT_PRICE" />
		<result property="matInoutPrice" column="MAT_INOUT_PRICE" />
	</resultMap>
	<resultMap id="comMaterial"
		type="mes.mat.matr.service.ComMaterialVO">
		<result property="comMaterialCode" column="COM_MATERIAL_CODE" />
		<result property="comMaterialName" column="COM_MATERIAL_NAME" />
		<result property="comMaterialBarcode" column="COM_MATERIAL_BARCODE" />
		<result property="comMaterialSize" column="COM_MATERIAL_SIZE" />
		<result property="comMaterialUnit" column="COM_MATERIAL_UNIT" />
		<result property="comMaterialVendorCode" column="COM_MATERIAL_VENDOR_CODE" />
		<result property="comMaterialSafetyStock" column="COM_MATERIAL_SAFETY_STOCK" />
		<result property="comMaterialMin" column="COM_MATERIAL_MIN" />
		<result property="comMaterialMax" column="COM_MATERIAL_MAX" />
	</resultMap>
	<resultMap type="mes.main.map.ResultMapVO" id="resultMaps">
		<collection property="orderVO" resultMap="erpMaterialOrder" />
		<collection property="matInoutVO" resultMap="matInout" />
		<collection property="matrVO" resultMap="comMaterial" />
		<collection property="matrChkVO" resultMap="quaMaterialChk" />
	</resultMap>
	
	<insert id="insertQuaMaterialChk">
		<![CDATA[
			INSERT INTO QUA_MATERIAL_CHK 
				( QUA_MATERIAL_STATEMENT
				  , QUA_MATERIAL_DATE
				  , ERP_VENDOR_CODE
				  , COM_MATERIAL_CODE
				  , QUA_MATERIAL_CHK
				  , QUA_MATERIAL_P_QTY
				  , QUA_MATERIAL_F_QTY
				  , QUA_MATERIAL_CHK_DATE
				  , ERP_MATERIAL_ORDER_CODE )
			VALUES ( #{quaMaterialStatement}
				  , #{quaMaterialDate}
				  , #{erpVendorCode}
				  , #{comMaterialCode}
				  , #{quaMaterialChk}
				  , #{quaMaterialPQty}
				  , #{quaMaterialFQty}
				  , #{quaMaterialChkDate}
				  , #{erpMaterialOrderCode} )
		]]>
	</insert>
	
	<update id="updateQuaMaterialChk">
		<![CDATA[
			UPDATE QUA_MATERIAL_CHK
			SET QUA_MATERIAL_STATEMENT=#{quaMaterialStatement}
				, QUA_MATERIAL_DATE=#{quaMaterialDate}
				, ERP_VENDOR_CODE=#{erpVendorCode}
				, COM_MATERIAL_CODE=#{comMaterialCode}
				, QUA_MATERIAL_CHK=#{quaMaterialChk}
				, QUA_MATERIAL_P_QTY=#{quaMaterialPQty}
				, QUA_MATERIAL_F_QTY=#{quaMaterialFQty}
				, QUA_MATERIAL_CHK_DATE=#{quaMaterialChkDate}
				, ERP_MATERIAL_ORDER_CODE=#{erpMaterialOrderCode}
						WHERE QUA_MATERIAL_STATEMENT=#{quaMaterialStatement}
				]]>
	</update>
	
	<delete id="deleteQuaMaterialChk">
		<![CDATA[
			DELETE FROM QUA_MATERIAL_CHK 
						WHERE QUA_MATERIAL_STATEMENT=#{quaMaterialStatement}
				]]>
	</delete>
	
	<select id="selectQuaMaterialChk" resultMap="quaMaterialChk">
		<![CDATA[
			SELECT
				QUA_MATERIAL_STATEMENT
				, QUA_MATERIAL_DATE
				, ERP_VENDOR_CODE
				, COM_MATERIAL_CODE
				, QUA_MATERIAL_CHK
				, QUA_MATERIAL_P_QTY
				, QUA_MATERIAL_F_QTY
				, QUA_MATERIAL_CHK_DATE
				, ERP_MATERIAL_ORDER_CODE
			FROM QUA_MATERIAL_CHK
						WHERE QUA_MATERIAL_STATEMENT=#{quaMaterialStatement}
				]]>
	</select>
	
	<select id="selectQuaMaterialChkList" parameterType="mes.qua.chk.service.QuaMaterialChkVO" resultType="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								QUA_MATERIAL_STATEMENT
								, QUA_MATERIAL_DATE
								, ERP_VENDOR_CODE
								, COM_MATERIAL_CODE
								, QUA_MATERIAL_CHK
								, QUA_MATERIAL_P_QTY
								, QUA_MATERIAL_F_QTY
								, QUA_MATERIAL_CHK_DATE
								, ERP_MATERIAL_ORDER_CODE
						FROM QUA_MATERIAL_CHK
				WHERE 1=1
				<if test="searchKeyword != null and searchKeyword != ''">
					<if test="searchCondition == 0">AND
						QUA_MATERIAL_STATEMENT = #{searchKeyword}
					</if>
					<if test="searchCondition == 1">AND
						QUA_MATERIAL_DATE LIKE '%' || #{searchKeyword} || '%'
					</if>
				</if>
					ORDER BY 
						QUA_MATERIAL_STATEMENT DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #{lastIndex}
)WHERE RNUM > #{firstIndex}
]]>
	</select>	
	<select id="selectQuaMaterialChkListTotCnt" parameterType="mes.qua.chk.service.QuaMaterialChkVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM QUA_MATERIAL_CHK
			WHERE 1=1
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					QUA_MATERIAL_STATEMENT = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					QUA_MATERIAL_DATE LIKE '%' || #{searchKeyword} || '%'
				</if>
			</if>
	</select>
	<!-- 자재입고검사조회 전체리스트  -->
	<select id="selectMatrChkList" resultMap="resultMaps">
		
	</select>
</mapper>
