<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mes.pro.order.service.impl.ProOrderDetailMapper">
	

	<resultMap id="proOrderDetail" type="mes.pro.order.service.ProOrderDetailVO">
		<result property="proOrderDetailCode" column="PRO_ORDER_DETAIL_CODE" />
		<result property="proOrderCode" column="PRO_ORDER_CODE" />
		<result property="proPlanDetailCode" column="PRO_PLAN_DETAIL_CODE" />
		<result property="erpProductDeadline" column="ERP_PRODUCT_DEADLINE" />
		<result property="proOrderDate" column="PRO_ORDER_DATE" />
		<result property="erpCustomerCode" column="ERP_CUSTOMER_CODE" />
		<result property="proOrderExpectQty" column="PRO_ORDER_EXPECT_QTY" />
		<result property="proOrderDayQty" column="PRO_ORDER_DAY_QTY" />
		<result property="proOrderSeq" column="PRO_ORDER_SEQ" />
		<result property="proOrderOrderQty" column="PRO_ORDER_ORDER_QTY" />
		<result property="proOrderQty" column="PRO_ORDER_QTY" />
	</resultMap>
	
	<insert id="insertProOrderDetail">
		<![CDATA[
			INSERT INTO PRO_ORDER_DETAIL 
				( PRO_ORDER_DETAIL_CODE
				  , PRO_ORDER_CODE
				  , PRO_PLAN_DETAIL_CODE
				  , ERP_PRODUCT_DEADLINE
				  , PRO_ORDER_DATE
				  , ERP_CUSTOMER_CODE
				  , PRO_ORDER_EXPECT_QTY
				  , PRO_ORDER_DAY_QTY
				  , PRO_ORDER_SEQ
				  , PRO_ORDER_ORDER_QTY
				  , PRO_ORDER_QTY )
			VALUES ( #{proOrderDetailCode}
				  , #{proOrderCode}
				  , #{proPlanDetailCode}
				  , #{erpProductDeadline}
				  , #{proOrderDate}
				  , #{erpCustomerCode}
				  , #{proOrderExpectQty}
				  , #{proOrderDayQty}
				  , #{proOrderSeq}
				  , #{proOrderOrderQty}
				  , #{proOrderQty} )
		]]>
	</insert>
	
	<update id="updateProOrderDetail">
		<![CDATA[
			UPDATE PRO_ORDER_DETAIL
			SET PRO_ORDER_DETAIL_CODE=#{proOrderDetailCode}
				, PRO_ORDER_CODE=#{proOrderCode}
				, PRO_PLAN_DETAIL_CODE=#{proPlanDetailCode}
				, ERP_PRODUCT_DEADLINE=#{erpProductDeadline}
				, PRO_ORDER_DATE=#{proOrderDate}
				, ERP_CUSTOMER_CODE=#{erpCustomerCode}
				, PRO_ORDER_EXPECT_QTY=#{proOrderExpectQty}
				, PRO_ORDER_DAY_QTY=#{proOrderDayQty}
				, PRO_ORDER_SEQ=#{proOrderSeq}
				, PRO_ORDER_ORDER_QTY=#{proOrderOrderQty}
				, PRO_ORDER_QTY=#{proOrderQty}
						WHERE PRO_ORDER_DETAIL_CODE=#{proOrderDetailCode}
				]]>
	</update>
	
	<delete id="deleteProOrderDetail">
		<![CDATA[
			DELETE FROM PRO_ORDER_DETAIL 
						WHERE PRO_ORDER_DETAIL_CODE=#{proOrderDetailCode}
				]]>
	</delete>
	
	<select id="selectProOrderDetail" resultMap="proOrderDetail">
		<![CDATA[
			SELECT
				PRO_ORDER_DETAIL_CODE
				, PRO_ORDER_CODE
				, PRO_PLAN_DETAIL_CODE
				, ERP_PRODUCT_DEADLINE
				, PRO_ORDER_DATE
				, ERP_CUSTOMER_CODE
				, PRO_ORDER_EXPECT_QTY
				, PRO_ORDER_DAY_QTY
				, PRO_ORDER_SEQ
				, PRO_ORDER_ORDER_QTY
				, PRO_ORDER_QTY
			FROM PRO_ORDER_DETAIL
						WHERE PRO_ORDER_DETAIL_CODE=#{proOrderDetailCode}
				]]>
	</select>
	
	<select id="selectProOrderDetailList" parameterType="mes.pro.order.service.ProOrderDetailVO" resultType="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								PRO_ORDER_DETAIL_CODE
								, PRO_ORDER_CODE
								, PRO_PLAN_DETAIL_CODE
								, ERP_PRODUCT_DEADLINE
								, PRO_ORDER_DATE
								, ERP_CUSTOMER_CODE
								, PRO_ORDER_EXPECT_QTY
								, PRO_ORDER_DAY_QTY
								, PRO_ORDER_SEQ
								, PRO_ORDER_ORDER_QTY
								, PRO_ORDER_QTY
						FROM PRO_ORDER_DETAIL
				WHERE 1=1
				<if test="searchKeyword != null and searchKeyword != ''">
					<if test="searchCondition == 0">AND
						PRO_ORDER_DETAIL_CODE = #{searchKeyword}
					</if>
					<if test="searchCondition == 1">AND
						PRO_ORDER_CODE LIKE '%' || #{searchKeyword} || '%'
					</if>
				</if>
					ORDER BY 
						PRO_ORDER_DETAIL_CODE DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #{lastIndex}
)WHERE RNUM > #{firstIndex}
]]>
	</select>	
	<select id="selectProOrderDetailListTotCnt" parameterType="mes.pro.order.service.ProOrderDetailVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM PRO_ORDER_DETAIL
			WHERE 1=1
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					PRO_ORDER_DETAIL_CODE = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					PRO_ORDER_CODE LIKE '%' || #{searchKeyword} || '%'
				</if>
			</if>
	</select>

</mapper>
